<div id="classification-result" class="space-y-6 animate-fade-in">
  <!-- New Classification Button -->
  <div class="flex items-center justify-between">
    <h3 class="text-lg font-semibold text-foreground">Resultado da Análise</h3>
    <button 
    type="button"
    onclick="resetClassification()"
    class="text-sm text-primary hover:text-primary/80 font-medium transition-colors">
      Nova Classificação
    </button>
  </div>
  
  <!-- Category Badge -->
  <div class="flex items-center gap-3">
    <span class="text-sm font-medium text-muted-foreground">
      Classificação:
    </span>

    {% if result.category == "produtivo" %}
      <span
        class="badge-productive"
        role="status"
        aria-label="Email classificado como produtivo"
      >
        <!-- CheckCircle -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-icon lucide-circle-check h-4 w-4"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
        <span class="capitalize">produtivo</span>
      </span>
    {% else %}
      <span
        class="badge-unproductive"
        role="status"
        aria-label="Email classificado como improdutivo"
      >
        <!-- XCircle -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-x-icon lucide-circle-x h-4 w-4"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
        <span class="capitalize">improdutivo</span>
      </span>
    {% endif %}
  </div>

  <!-- Suggested Response -->
  <div class="space-y-3">
    <div class="flex items-center gap-2 text-sm font-medium text-foreground">
      <!-- MessageSquare -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-icon lucide-message-square w-4 h-4 text-primary"><path d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"/></svg>
      <span>Resposta Sugerida</span>
    </div>

    <div
      id="suggested-response"
      class="relative p-4 rounded-lg border border-border bg-secondary/30"
    >
      <pre
        id="response-text"
        class="text-sm text-foreground leading-relaxed whitespace-pre-wrap pr-10"
      >{{ result.suggested_response }}</pre>

      <!-- Copy button -->
      <button
        type="button"
        onclick="copySuggestedResponse(this)"
        class="absolute top-3 right-3 p-2 rounded-md
               text-muted-foreground hover:text-foreground hover:bg-secondary
               transition-all duration-200"
        aria-label="Copiar resposta"
      >
        <!-- Copy icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy w-4 h-4"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
      </button>
    </div>
  </div>
</div>

<script>
  // Usei JavaScript apenas para uma ação pontual (clipboard), que não faz sentido roundtripar para o servidor. 
  function copySuggestedResponse(button) {
    const text = document.getElementById("response-text").innerText;

    navigator.clipboard.writeText(text).then(() => {
      button.classList.remove("text-muted-foreground");
      button.classList.add("text-success");

      button.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-icon lucide-check w-4 h-4"><path d="M20 6 9 17l-5-5"/></svg>
      `;

      setTimeout(() => {
        button.classList.remove("text-success");
        button.classList.add("text-muted-foreground");
        button.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy w-4 h-4"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
        `;
      }, 2000);
    });
  }

  function resetClassification() {
    // Hide results
    document.getElementById('results-section').classList.add('hidden');
    document.getElementById('results-section').innerHTML = ''; // Clear content to prevent flash on next show
    
    // Clear inputs
    const textarea = document.getElementById('email-content');
    if (textarea) textarea.value = '';
    
    const fileInput = document.getElementById('file');
    if (fileInput) fileInput.value = '';
    
    // Scroll to input
    const inputSection = document.getElementById('input-section');
    if (inputSection) inputSection.scrollIntoView({ behavior: 'smooth' });
  }
</script>
